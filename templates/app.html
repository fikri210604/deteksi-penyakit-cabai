<!doctype html>
<html lang="id">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Sistem Pakar Cabai{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@400" rel="stylesheet" />
</head>

<body class="bg-gray-50 text-gray-900 flex flex-col min-h-screen">

  <header class="bg-white shadow-sm sticky top-0 z-30">
    <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
      <a href="{{ url_for('index') }}" class="flex items-center gap-2 font-bold text-red-700 text-lg">
        <span class="material-symbols-outlined text-red-700">local_florist</span>
        Sistem Pakar Cabai
      </a>
      {% if current_user.is_authenticated %}
      <button onclick="toggleSidebar()"
        class="md:hidden px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 transition">
        <span class="material-symbols-outlined">menu</span>
      </button>
      {% endif %}
      <div class="hidden md:flex items-center gap-4">
        {% if current_user.is_authenticated %}
        <span class="font-medium text-gray-700 text-sm">Halo, {{ current_user.username }}</span>
        <a href="{{ url_for('auth_bp.logout') }}"
          class="px-4 py-2 bg-red-500 text-white rounded-lg text-sm hover:bg-red-600 transition">
          Logout
        </a>
        {% else %}
        <a href="{{ url_for('auth_bp.login') }}"
          class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 transition">
          Masuk
        </a>
        <a href="{{ url_for('auth_bp.register') }}"
          class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg text-sm hover:bg-gray-100 transition">
          Daftar
        </a>
        {% endif %}
      </div>
    </div>
  </header>

  <!-- ===================== PAGE WRAPPER ===================== -->
  <div class="flex flex-1">
    <!-- ===================== SIDEBAR ===================== -->
    {% if current_user.is_authenticated %}
    <aside id="sidebar"
      class="w-64 bg-white border-r shadow-sm fixed md:static inset-y-0 left-0 transform -translate-x-full md:translate-x-0 transition-transform duration-200 z-40">
      <div class="p-4 border-b flex items-center justify-between">
        <p class="font-semibold text-gray-700 text-sm">Navigasi</p>
        <button class="md:hidden" onclick="toggleSidebar()">
          <span class="material-symbols-outlined text-gray-700">close</span>
        </button>
      </div>
      <nav class="p-3 text-sm space-y-1">
        {% if current_user.role == 'admin' %}
        <a href="{{ url_for('admin_bp.dashboard') }}"
          class="block px-3 py-2 rounded hover:bg-gray-100 text-gray-700 font-medium transition">
          Dashboard Admin
        </a>
        <a href="{{ url_for('gejala_bp.index') }}"
          class="block px-3 py-2 rounded hover:bg-gray-100 text-gray-700 font-medium transition">
          Kelola Gejala
        </a>
        <a href="{{ url_for('penyakit_bp.index') }}"
          class="block px-3 py-2 rounded hover:bg-gray-100 text-gray-700 font-medium transition">
          Kelola Penyakit
        </a>
        <a href="{{ url_for('rule_bp.groups') }}"
          class="block px-3 py-2 rounded hover:bg-gray-100 text-gray-700 font-medium transition">
          Kelola Rule
        </a>
        <a href="{{ url_for('admin_bp.users') }}"
          class="block px-3 py-2 rounded hover:bg-gray-100 text-gray-700 font-medium transition">
          Data User
        </a>
        {% else %}
        <a href="{{ url_for('user_bp.dashboard') }}"
          class="block px-3 py-2 rounded hover:bg-gray-100 text-gray-700 font-medium transition">
          Input Gejala
        </a>
        <a href="{{ url_for('user_bp.history') }}"
          class="block px-3 py-2 rounded hover:bg-gray-100 text-gray-700 font-medium transition">
          Riwayat
        </a>
        {% endif %}
        <a href="{{ url_for('auth_bp.logout') }}"
          class="block px-3 py-2 rounded text-red-600 hover:bg-red-50 font-semibold">
          Logout
        </a>
      </nav>
    </aside>
    {% endif %}

    <main class="flex-1 md:ml-0 mt-16 md:mt-0">
      <div class="max-w-6xl mx-auto px-4 py-6">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="space-y-2 mb-4">
          {% for category, message in messages %}
          {% set color = 'blue' %}
          {% if category == 'success' %}{% set color = 'green' %}{% endif %}
          {% if category == 'warning' %}{% set color = 'yellow' %}{% endif %}
          {% if category in ['danger', 'error'] %}{% set color = 'red' %}{% endif %}

          <div class="flex items-center gap-2 border-l-4 pl-3 py-2 bg-white border-{{ color }}-500 text-sm rounded shadow-sm">
            <span class="material-symbols-outlined text-{{ color }}-500">info</span>
            {{ message }}
          </div>
          {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
      </div>
    </main>
  </div>

  <footer class="mt-10 py-8 bg-white border-t">
    <div class="max-w-7xl mx-auto px-4 text-center text-sm text-gray-600">
      <p class="font-semibold text-gray-700">Sistem Pakar Diagnosa Penyakit Cabai</p>
      <p class="text-gray-500 mt-1">Dibangun menggunakan Fuzzy-Sugeno & Rule-Based Expert System</p>
      <div class="flex justify-center gap-4 mt-4 text-gray-400">
        <a href="#" class="hover:text-green-700 transition">Kebijakan Privasi</a>
        <a href="#" class="hover:text-green-700 transition">Syarat & Ketentuan</a>
        <a href="mailto:admin@sistempakar.com" class="hover:text-green-700 transition">Kontak</a>
      </div>
      <p class="mt-4 text-gray-400 text-xs">
        &copy; {{ 2025 }} Sistem Pakar Cabai â€” All Rights Reserved
      </p>
    </div>
  </footer>

  <script>
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('-translate-x-full');
    }
  </script>

</b
